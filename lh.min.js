const prompt=require("prompt"),lighthouse=require("lighthouse"),launchChrome=require("chrome-launcher"),argv=require("yargs").argv,url=require("url"),fs=require("fs"),chromeAndLighthouse=url=>launchChrome.launch().then(chrome=>{const options={port:chrome.port,output:"html"};return lighthouse(url,options).then(results=>chrome.kill().then(()=>({js:results.lhr,json:results.report})))});prompt.start(),prompt.get("url",(function(err,result){if(argv.url=result.url,!argv.url)throw"URL을 입력하세요";{const urlObj=new URL(argv.url);let dirName=urlObj.host.replace("www.","");"/"!==urlObj.pathname&&(dirName+=urlObj.pathname.replace(/\//g,"_")),fs.existsSync(dirName)||fs.mkdirSync(dirName),chromeAndLighthouse(argv.url).then(results=>{fs.writeFile(`${dirName}/${results.js.fetchTime.replace(/:/g,"_")}.html`,results.json,err=>{if(err)throw err})})}}));